<?xml version="1.0" encoding="UTF-8"?><?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<SharedFlow name="GeneralApiSecurityFaultHandler">
    <Step>
        <Condition>flow.api.variables.isOriginAllowed = false</Condition>
        <FaultRules/>
        <Name>AM-InvalidOriginErrorVariables</Name>
    </Step>
    <Step>
        <Condition>(fault.name = "InvalidApiKey") OR (fault.name = "FailedToResolveAPIKey") OR (fault.name = "InvalidApiKeyForGivenResource") OR (fault.name = "FailedToResolveAPIKey") OR (fault.name = "ApiKeyNotApproved") OR (fault.name = "DeveloperStatusNotActive") OR (fault.name = "CompanyStatusNotActive") OR (fault.name = "app_not_approved")</Condition>
        <FaultRules/>
        <Name>AM-InvalidApiKeyErrorVariables</Name>
    </Step>
    <Step>
        <Condition>messagevalidation.failed = "true"</Condition>
        <FaultRules/>
        <Name>AM-MessageValidationBadRequestErrorVariables</Name>
    </Step>
    <Step>
        <Condition>(fault.name = "ExceededContainerDepth") OR (fault.name = "ExceededObjectEntryCount") OR (fault.name = "ExceededArrayElementCount") OR (fault.name = "ExceededObjectEntryNameLength") OR (fault.name = "ExceededStringValueLength") OR (fault.name = "SourceUnavailable") OR (fault.name = "NonMessageVariable") OR (fault.name = "ExecutionFailed")</Condition>
        <FaultRules/>
        <Name>AM-BadRequestErrorVariables</Name>
    </Step>
    <Step>
        <Condition>(JWT.failed = "true")</Condition>
        <FaultRules/>
        <Name>AM-InvalidJWTErrorVariables</Name>
    </Step>
    <Step>
        <Condition>(JWT.failed = "true") AND (fault.name = "NoMatchingPublicKey" OR fault.name = "InvalidToken")</Condition>
        <FaultRules/>
        <Name>FC-GetIdcsPublicKeys</Name>
    </Step>
    <Step>
        <Condition>(fault.name = "TokenExpired") OR (fault.name = "access_token_expired")</Condition>
        <FaultRules/>
        <Name>AM-AccessTokenExpiredErrorVariables</Name>
    </Step>
    <Step>
        <Condition>(fault.name = "InvalidAccessToken") OR (fault.name = "invalid_access_token")</Condition>
        <FaultRules/>
        <Name>AM-InvalidAccessTokenErrorVariables</Name>
    </Step>
    <Step>
        <Condition>(fault.name = "access_token_not_approved")</Condition>
        <FaultRules/>
        <Name>AM-InvalidAccessTokenErrorVariables</Name>
    </Step>
    <Step>
        <Condition>(fault.name = "IPDeniedAccess")</Condition>
        <Name>AM-InvalidClientIPErrorVariables</Name>
    </Step>
    <Step>
        <Condition>(flow.api.error.code != null)</Condition>
        <FaultRules/>
        <Name>RF-GenericFaultPolicy</Name>
    </Step>
</SharedFlow>